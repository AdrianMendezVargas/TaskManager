@page "/"
@attribute [Authorize]

@inject IAccountService _accountService;

<AuthorizeView>
    <Authorized>
        <div>

            <h1>Your Dashboard - Your Claims</h1>
            <div>
                @foreach (var claim in userClaim) {
                    <div>@claim.Type - @claim.Value</div>
                }
            </div>
            <div>
                <button type="button" class="btn btn-primary" @onclick="Logout">Logout</button>
            </div>

        </div>
    </Authorized>
</AuthorizeView>



@code{
    [CascadingParameter]
    private Task<AuthenticationState> authenticationState { get; set; }
    private IList<Claim> userClaim {
        get {
            var auth = authenticationState.Result;
            if (auth.User.Identity.IsAuthenticated) {
                return auth.User.Claims.ToList();
            }
            return new List<Claim>();
        }
    }

    private async void Logout() {
        try {
            await _accountService.LogoutAsync();
        } catch (Exception e) {

            Console.WriteLine(e.Message);
        }
    }
}